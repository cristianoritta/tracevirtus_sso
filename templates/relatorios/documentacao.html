{% extends 'layout/base.html' %}

{% block content %}
<div class="container-fluid">
    <!-- Navigation Cards -->
    <div class="row mb-4 g-3">
        <div class="col-md-3">
            <div class="card h-100 border-0 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <i class="fas fa-database text-primary fa-2x mb-3"></i>
                    <h6 class="card-title">Estrutura de Dados</h6>
                    <p class="card-text small text-muted">Organiza√ß√£o completa dos dados retornados</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card h-100 border-0 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <i class="fas fa-code text-success fa-2x mb-3"></i>
                    <h6 class="card-title">Casos de Uso</h6>
                    <p class="card-text small text-muted">Exemplos pr√°ticos de implementa√ß√£o</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card h-100 border-0 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <i class="fas fa-lightbulb text-warning fa-2x mb-3"></i>
                    <h6 class="card-title">Melhores Pr√°ticas</h6>
                    <p class="card-text small text-muted">Dicas e insights para desenvolvimento</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card h-100 border-0 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <i class="fas fa-download text-info fa-2x mb-3"></i>
                    <h6 class="card-title">Exporta√ß√£o</h6>
                    <p class="card-text small text-muted">Formatos de sa√≠da de dados</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row">
        <div class="col-lg-3">
            <!-- Sidebar Navigation -->
            <div class="card border-0 shadow-sm sticky-top">
                <div class="card-header bg-light border-0">
                    <h6 class="mb-0"><i class="fas fa-list-ul me-2"></i>√çndice</h6>
                </div>
                <div class="card-body p-0">
                    <nav class="nav flex-column">
                        <a class="nav-link py-3 border-bottom" href="#estrutura"><i
                                class="fas fa-sitemap me-2"></i>Estrutura de Dados</a>
                        <a class="nav-link py-3 border-bottom" href="#rifs"><i
                                class="fas fa-file-invoice me-2"></i>RIFs</a>
                        <a class="nav-link py-3 border-bottom" href="#titulares"><i
                                class="fas fa-user me-2"></i>Titulares</a>
                        <a class="nav-link py-3 border-bottom" href="#titulares-extratos"><i
                                class="fas fa-chart-line me-2"></i>Titulares Extratos</a>
                        <a class="nav-link py-3 border-bottom" href="#envolvidos"><i
                                class="fas fa-users me-2"></i>Envolvidos</a>
                        <a class="nav-link py-3 border-bottom" href="#arquivos"><i
                                class="fas fa-file me-2"></i>Arquivos</a>
                        <a class="nav-link py-3 border-bottom" href="#casos-uso"><i class="fas fa-cogs me-2"></i>Casos
                            de Uso</a>
                        <a class="nav-link py-3" href="#praticas"><i class="fas fa-star me-2"></i>Melhores Pr√°ticas</a>
                    </nav>
                </div>
            </div>
        </div>

        <div class="col-lg-9">
            <!-- Estrutura de Dados Section -->
            <div id="estrutura" class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-gradient-info text-white">
                    <h4 class="mb-0"><i class="fas fa-sitemap me-2"></i>üìä Estrutura de Dados Retornados</h4>
                </div>
                <div class="card-body">
                    <p class="lead mb-4">O dicion√°rio <code class="bg-light px-2 py-1 rounded">data</code> retornado
                        pela fun√ß√£o <code class="bg-light px-2 py-1 rounded">relatorio_documento</code> cont√©m as
                        seguintes chaves principais:</p>

                    <!-- RIFs -->
                    <div id="rifs" class="mb-5">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary rounded-circle p-2 me-3">
                                <i class="fas fa-file-invoice text-white"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">1. RIFs (QuerySet de objetos RIF)</h5>
                                <span class="badge bg-primary">Relat√≥rios de Intelig√™ncia Financeira</span>
                            </div>
                        </div>

                        <div class="alert alert-light border-start border-4 border-primary">
                            <p class="mb-2"><strong>Descri√ß√£o:</strong> Lista de todos os RIFs associados ao caso.</p>
                            <p class="mb-0"><strong>Campos dispon√≠veis:</strong></p>
                            <ul class="mb-0">
                                <li><code>id</code> - Identificador √∫nico do RIF</li>
                                <li><code>numero</code> - N√∫mero do RIF</li>
                                <li><code>caso</code> - Refer√™ncia ao caso associado</li>
                            </ul>
                        </div>

                        <div class="bg-dark rounded">
                            <pre class="text-light">
                                <code>
                                    {% templatetag openblock %} for rif in rifs {% templatetag openblock %}
                                        RIF n¬∫ &#123;&#123; rif.numero &#125;&#125; - ID: &#123;&#123; rif.id &#125;&#125;
                                    {% templatetag openblock %} endfor {% templatetag closeblock %}
                                </code>
                            </pre>
                        </div>
                    </div>

                    <!-- Titulares -->
                    <div id="titulares" class="mb-5">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-success rounded-circle p-2 me-3">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">2. Titulares (Lista de objetos Titular)</h5>
                                <span class="badge bg-success">Pessoas F√≠sicas/Jur√≠dicas Principais</span>
                            </div>
                        </div>

                        <div class="alert alert-light border-start border-4 border-success">
                            <p class="mb-2"><strong>Descri√ß√£o:</strong> Lista dos titulares principais das contas
                                banc√°rias analisadas.</p>
                            <p class="mb-0"><strong>Campos principais:</strong></p>
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <ul class="mb-0">
                                        <li><code>nome_envolvido</code> - Nome completo</li>
                                        <li><code>tipo_envolvido</code> - "Titular" ou "Representante"</li>
                                        <li><code>creditos</code> - Total de cr√©ditos</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="mb-0">
                                        <li><code>debitos</code> - Total de d√©bitos</li>
                                        <li><code>cpf_cnpj_titular</code> - Documento do titular</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="bg-dark rounded p-3">
                            <pre class="text-light mb-0"><code>{% templatetag openblock %} for titular in titulares {% templatetag closeblock %}
    {{ titular.nome_envolvido }}, {{ titular.tipo_envolvido }}
    Cr√©ditos: R$ {{ titular.creditos }}
    D√©bitos: R$ {{ titular.debitos }}
{% templatetag openblock %} endfor {% templatetag closeblock %}</code></pre>
                        </div>
                    </div>

                    <!-- Titulares Extratos -->
                    <div id="titulares-extratos" class="mb-5">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-warning rounded-circle p-2 me-3">
                                <i class="fas fa-chart-line text-white"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">3. Titulares Extratos (Lista Complexa)</h5>
                                <span class="badge bg-warning text-dark">An√°lise Detalhada por Titular</span>
                            </div>
                        </div>

                        <div class="alert alert-info border-0">
                            <h6><i class="fas fa-info-circle me-2"></i>Estrutura Complexa</h6>
                            <p class="mb-0">Cada titular cont√©m dados agregados com an√°lise completa de movimenta√ß√µes
                                financeiras.</p>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card border-primary">
                                    <div class="card-body text-center">
                                        <h6 class="text-primary">Dados B√°sicos</h6>
                                        <small class="text-muted">nome, cpf, investigado</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-success">
                                    <div class="card-body text-center">
                                        <h6 class="text-success">Financeiros</h6>
                                        <small class="text-muted">movimentacao_total, creditos, debitos</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning">
                                    <div class="card-body text-center">
                                        <h6 class="text-warning">An√°lises</h6>
                                        <small class="text-muted">kyc, observacoes_analista, ocorrencias</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-dark rounded p-3 mt-3">
                            <pre class="text-light mb-0">
                                <code>
                                {% templatetag openblock %} for alvo in titulares_extratos {% templatetag closeblock %}
    {{ alvo.nome }}
    CPF: {{ alvo.cpf }}
    Movimenta√ß√£o Total: {{ alvo.movimentacao_total }}
    
    {% templatetag openblock %} for antecedente in alvo.antecedentes {% templatetag closeblock %}
        {{ antecedente.data_comunicacao }} | {{ antecedente.ocorrencia }}
    {% templatetag openblock %} endfor {% templatetag closeblock %}
    
    {% templatetag openblock %} for comunicacao in alvo.envolvimentos {% templatetag closeblock %}
        {{ comunicacao.nomeEnvolvido }} - {{ comunicacao.tipoEnvolvido }}
    {% templatetag openblock %} endfor {% templatetag closeblock %}
{% templatetag openblock %} endfor {% templatetag closeblock %}
</code>
</pre>
                        </div>
                    </div>

                    <!-- Envolvidos -->
                    <div id="envolvidos" class="mb-5">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-info rounded-circle p-2 me-3">
                                <i class="fas fa-users text-white"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">4. Envolvidos (QuerySet de objetos Envolvido)</h5>
                                <span class="badge bg-info">Pessoas Relacionadas</span>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-8">
                                <div class="alert alert-light border-start border-4 border-info">
                                    <p class="mb-2"><strong>Descri√ß√£o:</strong> Pessoas f√≠sicas ou jur√≠dicas envolvidas
                                        no caso.</p>
                                    <p class="mb-0"><strong>Campos dispon√≠veis:</strong></p>
                                    <ul class="mb-0">
                                        <li><code>cpf_cnpj_envolvido</code> - Documento</li>
                                        <li><code>nome_envolvido</code> - Nome completo</li>
                                        <li><code>tipo_envolvido</code> - "Titular" ou "Representante"</li>
                                        <li><code>cpf_cnpj_titular</code> - Documento do titular relacionado</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-light">
                                    <div class="card-body text-center">
                                        <h6 class="card-title">Tipos de Envolvidos</h6>
                                        <span class="badge bg-primary me-1">Titular</span>
                                        <span class="badge bg-secondary">Representante</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-dark rounded p-3">
                            <pre class="text-light mb-0"><code>{% templatetag openblock %} for envolvido in envolvidos {% templatetag closeblock %}
    {{ envolvido.nome_envolvido }} ({{ envolvido.tipo_envolvido }})
    CPF/CNPJ: {{ envolvido.cpf_cnpj_envolvido }}
{% templatetag openblock %} endfor {% templatetag closeblock %}</code></pre>
                        </div>
                    </div>

                    <!-- Arquivos -->
                    <div id="arquivos" class="mb-5">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-secondary rounded-circle p-2 me-3">
                                <i class="fas fa-file text-white"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">5. Arquivos (Lista de objetos Arquivo)</h5>
                                <span class="badge bg-secondary">Arquivos Importados</span>
                            </div>
                        </div>

                        <div class="alert alert-light border-start border-4 border-secondary">
                            <p class="mb-2"><strong>Descri√ß√£o:</strong> Lista dos arquivos importados com seus hashes de
                                verifica√ß√£o.</p>
                            <p class="mb-0"><strong>Campos dispon√≠veis:</strong></p>
                            <ul class="mb-0">
                                <li><code>nome</code> - Nome do arquivo</li>
                                <li><code>hash</code> - Hash de verifica√ß√£o do arquivo</li>
                            </ul>
                        </div>

                        <div class="bg-dark rounded p-3">
                            <pre class="text-light mb-0"><code>{% templatetag openblock %} for arquivo in arquivos {% templatetag closeblock %}
    {{ arquivo.nome }} - Hash: {{ arquivo.hash }}
{% templatetag openblock %} endfor {% templatetag closeblock %}</code></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Casos de Uso -->
            <div id="casos-uso" class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-gradient-success text-white">
                    <h4 class="mb-0"><i class="fas fa-cogs me-2"></i>üéØ Casos de Uso Comuns</h4>
                </div>
                <div class="card-body">
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="card border-primary h-100">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0"><i class="fas fa-file-alt me-2"></i>Cabe√ßalho do Relat√≥rio</h6>
                                </div>
                                <div class="card-body">
                                    <div class="bg-dark rounded p-3">
                                        <pre
                                            class="text-light mb-0 small"><code>RELAT√ìRIO T√âCNICO DE INTELIG√äNCIA FINANCEIRA
{% templatetag openblock %} for rif in rifs {% templatetag closeblock %}RIF: n¬∫ {{rif.numero}}{% templatetag openblock %} endfor {% templatetag closeblock %}

Suspeitos de Lavagem de Dinheiro:
{% templatetag openblock %} for titular in titulares{% templatetag closeblock %}
‚Ä¢ {{titular.nome_envolvido}}, {{titular.tipo_envolvido}}{% templatetag openblock %} endfor {% templatetag closeblock %}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card border-success h-100">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0"><i class="fas fa-table me-2"></i>Tabela de Movimenta√ß√µes</h6>
                                </div>
                                <div class="card-body">
                                    <div class="bg-dark rounded p-3">
                                        <pre class="text-light mb-0 small"><code>{% templatetag openblock %}tr for alvo in titulares {% templatetag closeblock %}
{{alvo.nome_envolvido}}	R$ {{alvo.creditos}}	R$ {{alvo.debitos}}
{% templatetag openblock %}tr endfor {% templatetag closeblock %}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card border-warning h-100">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0"><i class="fas fa-user me-2"></i>An√°lise por Titular</h6>
                                </div>
                                <div class="card-body">
                                    <div class="bg-dark rounded p-3">
                                        <pre class="text-light mb-0 small"><code>{% templatetag openblock %}p for alvo in titulares_extratos {% templatetag closeblock %}
{{ alvo.nome}}
Movimenta√ß√£o total: {{alvo.movimentacao_total}}
Cr√©ditos: {{alvo.creditos}}
D√©bitos: {{alvo.debitos}}

{% templatetag openblock %} for antecedente in alvo.antecedentes {% templatetag closeblock %}
‚Ä¢ {{antecedente.data_comunicacao}} | {{antecedente.ocorrencia}}
{% templatetag openblock %} endfor {% templatetag closeblock %}
{% templatetag openblock %} endfor {% templatetag closeblock %}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card border-info h-100">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0"><i class="fas fa-list me-2"></i>Lista de Envolvidos</h6>
                                </div>
                                <div class="card-body">
                                    <div class="bg-dark rounded p-3">
                                        <pre class="text-light mb-0 small"><code>{% templatetag openblock %} for titular in titulares {% templatetag closeblock %} 
‚Ä¢ Titular: {{ titular.nome_envolvido }} 
{% templatetag openblock %} for envolvido in envolvidos if envolvido['cpf_cnpj_titular'] == titular['cpf_cnpj_titular'] {% templatetag closeblock %}
o {{ envolvido.tipo_envolvido }}: {{ envolvido.nome_envolvido }} 
{% templatetag openblock %} endfor {% templatetag closeblock %} 
{% templatetag openblock %} endfor {% templatetag closeblock %}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Melhores Pr√°ticas -->
            <div id="praticas" class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-gradient-warning text-dark">
                    <h4 class="mb-0"><i class="fas fa-star me-2"></i>üí° Insights e Melhores Pr√°ticas</h4>
                </div>
                <div class="card-body">
                    <div class="row g-4">
                        <div class="col-md-4">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body">
                                    <h6 class="card-title text-primary"><i class="fas fa-filter me-2"></i>Tags Especiais
                                    </h6>
                                    <p class="card-text small">Tags espec√≠ficas para tabelas e par√°grafos.</p>
                                    <div class="bg-dark rounded p-2">
                                        <pre class="text-light mb-0" style="font-size: 10px;"><code>{% templatetag openblock %}tr {% templatetag closeblock %} - Para linhas de tabela
{% templatetag openblock %}p {% templatetag closeblock %} - Para par√°grafos
{% templatetag openblock %} if {% templatetag closeblock %} - Para condicionais
{% templatetag openblock %} for {% templatetag closeblock %} - Para loops</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body">
                                    <h6 class="card-title text-success"><i class="fas fa-calculator me-2"></i>Formata√ß√£o
                                        Monet√°ria</h6>
                                    <p class="card-text small">Formata√ß√£o adequada de valores financeiros.</p>
                                    <div class="bg-dark rounded p-2">
                                        <pre class="text-light mb-0" style="font-size: 10px;"><code>R$ {{ valor }}
{{ valor|floatformat:2 }}
{{ valor }}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body">
                                    <h6 class="card-title text-info"><i class="fas fa-check me-2"></i>Valida√ß√µes</h6>
                                    <p class="card-text small">Verifica√ß√µes importantes nos dados.</p>
                                    <div class="bg-dark rounded p-2">
                                        <pre class="text-light mb-0"
                                            style="font-size: 10px;"><code>{% templatetag openblock %} if alvo['comunicacoes'] is not none {% templatetag closeblock %}
{% templatetag openblock %} if alvo['outras_informacoes']|length > 0 {% templatetag closeblock %}
{% templatetag openblock %} if envolvido['cpf_cnpj_titular'] == titular['cpf_cnpj_titular'] {% templatetag closeblock %}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notas Importantes -->
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-gradient-danger text-white">
                    <h4 class="mb-0"><i class="fas fa-exclamation-triangle me-2"></i>üìù Notas Importantes</h4>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning border-0 d-flex align-items-center">
                        <i class="fas fa-info-circle fa-2x me-3"></i>
                        <div>
                            <h6 class="mb-1">Tags Personalizadas</h6>
                            <p class="mb-0">As tags
                                <code>{% templatetag openblock %}tr {% templatetag closeblock %}</code> e
                                <code>{% templatetag openblock %}p {% templatetag closeblock %}</code> s√£o tags
                                personalizadas que devem estar registradas no sistema Django.
                            </p>
                        </div>
                    </div>

                    <div class="alert alert-info border-0 d-flex align-items-center">
                        <i class="fas fa-code fa-2x me-3"></i>
                        <div>
                            <h6 class="mb-1">Estrutura de Dados</h6>
                            <p class="mb-0">Os dados s√£o organizados hierarquicamente: RIFs ‚Üí Titulares ‚Üí Titulares
                                Extratos ‚Üí Envolvidos ‚Üí Comunica√ß√µes.</p>
                        </div>
                    </div>

                    <div class="alert alert-success border-0 d-flex align-items-center">
                        <i class="fas fa-database fa-2x me-3"></i>
                        <div>
                            <h6 class="mb-1">Campos Condicionais</h6>
                            <p class="mb-0">Alguns campos como <code>comunicacoes</code>,
                                <code>outras_informacoes</code> e <code>antecedentes</code> podem ser None ou vazios -
                                sempre verifique antes de usar.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-gradient-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .bg-gradient-info {
        background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
    }

    .bg-gradient-success {
        background: linear-gradient(135deg, #00b894 0%, #00a085 100%);
    }

    .bg-gradient-warning {
        background: linear-gradient(135deg, #fdcb6e 0%, #f39c12 100%);
    }

    .bg-gradient-danger {
        background: linear-gradient(135deg, #e17055 0%, #d63031 100%);
    }

    .hover-lift {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .hover-lift:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
    }

    .nav-link {
        transition: all 0.3s ease;
    }

    .nav-link:hover {
        background-color: #f8f9fa;
        padding-left: 1.5rem !important;
    }

    .card {
        transition: transform 0.3s ease;
    }

    .card:hover {
        transform: translateY(-2px);
    }

    pre {
        font-size: 12px;
        line-height: 1.4;
    }

    .sticky-top {
        top: 20px;
    }

    @media (max-width: 768px) {
        .display-4 {
            font-size: 2rem;
        }

        .sticky-top {
            position: relative !important;
            top: auto !important;
        }
    }
</style>

{% endblock %}